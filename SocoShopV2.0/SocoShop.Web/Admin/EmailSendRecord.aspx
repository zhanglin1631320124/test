<%@ Page Language="C#" MasterPageFile="MasterPage.Master" AutoEventWireup="True" CodeBehind="EmailSendRecord.aspx.cs" Inherits="SocoShop.Web.Admin.EmailSendRecord" %><%@ Import Namespace="SocoShop.Entity" %><%@ Import Namespace="SocoShop.Common" %><%@ Register Namespace="SkyCES.EntLib" Assembly="SkyCES.EntLib" TagPrefix="SkyCES"%><asp:Content ID="MasterContent" ContentPlaceHolderID="ContentPlaceHolder" runat="server"><div class="position"><img src="/Admin/Style/Images/PositionIcon.png"  alt=""/>邮件发送记录列表</div>	<div class="listBlock">    <ul>        <li <%if(isSystem==0){%>class="listOn"<%} %> onclick="window.location='EmailSendRecord.aspx'">普通邮件</li>        <li <%if(isSystem==1){%>class="listOn"<%} %> onclick="window.location='EmailSendRecord.aspx?IsSystem=1'">系统邮件</li>    </ul>	</div><table class="listTable" cellpadding="0" cellpadding="0">    <tr class="listTableHead">	    <td style="width:5%">ID</td>	    <td style="width:40%; text-align:left;text-indent:8px;">标题</td>  	    <td style="width:15%">添加时间</td>    	    <td style="width:15%">发送时间</td>    	    <td style="width:10%">状态</td>      	    <td style="width:10%">管理</td>         	    <td style="width:5%">选择</td>            </tr><asp:Repeater ID="RecordList" runat="server">	<ItemTemplate>	         	<tr class="listTableMain" onmousemove="changeColor(this,'#FFFDD7')" onmouseout="changeColor(this,'#FFF')">		    <td style="width:5%"><%# Eval("ID") %></td>		    <td style="width:40%; text-align:left;text-indent:8px;"><%# Eval("Title")%></td>		    <td style="width:15%"><%# Eval("AddDate")%></td>     		    <td style="width:15%" id="SendDate<%# Eval("ID") %>"><%#ShowSendDate(Convert.ToInt32(Eval("SendStatus")), Eval("SendDate").ToString())%></td>                <td style="width:10%" id="SendStatus<%# Eval("ID") %>"><%# EnumHelper.ReadEnumChineseName<SendStatus>(Convert.ToInt32(Eval("SendStatus")))%></td>           		    <td style="width:10%;">                <span id="Operate<%#Eval("ID")%>"><%# ShowSendButton(Convert.ToInt32(Eval("SendStatus")), Convert.ToInt32(Eval("ID")))%></span>		        <a href="javascript:pop('EmailSendRecordDetail.aspx?ID=<%# Eval("ID") %>',800,600,'营销详细','EmailSendDetailRecord')"><img src="Style/Images/list.gif" alt="详细" title="详细" /></a>		    </td>		    <td style="width:5%"><input type="checkbox" name="SelectID" value="<%# Eval("ID") %>" /></td> 	        	    </tr>    </ItemTemplate></asp:Repeater></table><div class="listPage"><SkyCES:CommonPager ID="MyPager" runat="server" /></div><div class="action">        <asp:Button CssClass="button" ID="DeleteButton" Text=" 删 除 " OnClientClick="return checkSelect()" runat="server"  OnClick="DeleteButton_Click"/>&nbsp;<input type="checkbox" name="All" onclick="selectAll(this)" />全选/取消</div><script language="javascript" type="text/javascript">var tempID;function sendEmail(id){    tempID=id;    o("SendStatus"+id).innerHTML="发送中";    o("Operate"+id).innerHTML="";     Ajax.requestURL("Ajax.aspx?Action=SendEmail&ID="+id,dealSendEmail);  }function dealSendEmail(data){    if(Validate.isTime(data)){        o("SendDate"+tempID).innerHTML=data;        o("SendStatus"+tempID).innerHTML="发送完成";    }    else{        o("SendStatus"+tempID).innerHTML="未发送";        alertMessage("发送失败，请检查Email配置和地址列表");    }}</script></asp:Content>